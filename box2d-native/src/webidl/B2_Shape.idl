[NoDelete]
interface B2_Shape {
    // Shape definition
    static void defaultShapeDef([Ref] b2ShapeDef result);

    // Shape creation functions
    static unsigned long long createCircleShape(unsigned long long bodyId, [Const] b2ShapeDef def, [Const] b2Circle circle);
    static unsigned long long createSegmentShape(unsigned long long bodyId, [Const] b2ShapeDef def, [Const] b2Segment segment);
    static unsigned long long createCapsuleShape(unsigned long long bodyId, [Const] b2ShapeDef def, [Const] b2Capsule capsule);
    static unsigned long long createPolygonShape(unsigned long long bodyId, [Const] b2ShapeDef def, [Const] b2Polygon polygon);

    // Shape destruction
    static void destroyShape(unsigned long long shapeId, boolean updateBodyMass);

    // Shape validation and properties
    static boolean isValid(unsigned long long id);
    static b2ShapeType getType(unsigned long long shapeId);
    static unsigned long long getBody(unsigned long long shapeId);
    [Value] static b2WorldId getWorld(unsigned long long shapeId);
    static boolean isSensor(unsigned long long shapeId);

    // Shape user data
    static void setUserData(unsigned long long shapeId, VoidPtr userData);
    static VoidPtr getUserData(unsigned long long shapeId);

    // Shape material properties
    static void setDensity(unsigned long long shapeId, float density, boolean updateBodyMass);
    static float getDensity(unsigned long long shapeId);
    static void setFriction(unsigned long long shapeId, float friction);
    static float getFriction(unsigned long long shapeId);
    static void setRestitution(unsigned long long shapeId, float restitution);
    static float getRestitution(unsigned long long shapeId);
    static void setMaterial(unsigned long long shapeId, long material);
    static long getMaterial(unsigned long long shapeId);
    static void setSurfaceMaterial(unsigned long long shapeId, [Value] b2SurfaceMaterial surfaceMaterial);
    [Value] static b2SurfaceMaterial getSurfaceMaterial(unsigned long long shapeId);

    // Shape filtering
    [Value] static b2Filter getFilter(unsigned long long shapeId);
    static void setFilter(unsigned long long shapeId, [Value] b2Filter filter);

    // Shape events
    static void enableSensorEvents(unsigned long long shapeId, boolean flag);
    static boolean areSensorEventsEnabled(unsigned long long shapeId);
    static void enableContactEvents(unsigned long long shapeId, boolean flag);
    static boolean areContactEventsEnabled(unsigned long long shapeId);
    static void enablePreSolveEvents(unsigned long long shapeId, boolean flag);
    static boolean arePreSolveEventsEnabled(unsigned long long shapeId);
    static void enableHitEvents(unsigned long long shapeId, boolean flag);
    static boolean areHitEventsEnabled(unsigned long long shapeId);

    // Shape testing and casting
    static boolean testPoint(unsigned long long shapeId, [Value] b2Vec2 point);
    [Value] static b2CastOutput rayCast(unsigned long long shapeId, [Const] b2RayCastInput input);

    // Shape geometry getters
    [Value] static b2Circle getCircle(unsigned long long shapeId);
    [Value] static b2Segment getSegment(unsigned long long shapeId);
    [Value] static b2ChainSegment getChainSegment(unsigned long long shapeId);
    [Value] static b2Capsule getCapsule(unsigned long long shapeId);
    [Value] static b2Polygon getPolygon(unsigned long long shapeId);

    // Shape geometry setters
    static void setCircle(unsigned long long shapeId, [Const] b2Circle circle);
    static void setCapsule(unsigned long long shapeId, [Const] b2Capsule capsule);
    static void setSegment(unsigned long long shapeId, [Const] b2Segment segment);
    static void setPolygon(unsigned long long shapeId, [Const] b2Polygon polygon);

    // Shape chain functions
    static unsigned long long getParentChain(unsigned long long shapeId);

    // Shape contact and sensor data
    static long getContactCapacity(unsigned long long shapeId);
    static long getContactData(unsigned long long shapeId, b2ContactDataArray contactData);
    static long getSensorCapacity(unsigned long long shapeId);
    static long getSensorOverlaps(unsigned long long shapeId, b2ShapeIdArray overlaps);

    // Shape AABB and mass
    [Value] static b2AABB getAABB(unsigned long long shapeId);
    [Value] static b2MassData getMassData(unsigned long long shapeId);
    [Value] static b2Vec2 getClosestPoint(unsigned long long shapeId, [Value] b2Vec2 target);
};

[NoDelete]
interface B2_Chain {
    // Chain definition
    static void defaultChainDef([Ref] b2ChainDef result);

    // Chain creation and destruction
    static unsigned long long createChain(unsigned long long bodyId, [Const] b2ChainDef def);
    static void destroyChain(unsigned long long chainId);

    // Chain validation and properties
    static boolean isValid(unsigned long long id);
    [Value] static b2WorldId getWorld(unsigned long long chainId);
    static long getSegmentCount(unsigned long long chainId);
    static long getSegments(unsigned long long chainId, b2ShapeIdArray segmentArray);

    // Chain material properties
    static void setFriction(unsigned long long chainId, float friction);
    static float getFriction(unsigned long long chainId);
    static void setRestitution(unsigned long long chainId, float restitution);
    static float getRestitution(unsigned long long chainId);
    static void setMaterial(unsigned long long chainId, long material);
    static long getMaterial(unsigned long long chainId);
};

[StackAllocatable]
interface b2ShapeDef {
    void b2ShapeDef();
    attribute VoidPtr userData;
    [Value] attribute b2SurfaceMaterial material;
    attribute float density;
    [Value] attribute b2Filter filter;
    attribute boolean isSensor;
    attribute boolean enableSensorEvents;
    attribute boolean enableContactEvents;
    attribute boolean enableHitEvents;
    attribute boolean enablePreSolveEvents;
    attribute boolean invokeContactCreation;
    attribute boolean updateBodyMass;
};

[StackAllocatable]
interface b2ChainDef {
    void b2ChainDef();
	attribute VoidPtr userData;
	attribute b2Vec2 points;
	attribute long count;
	attribute b2SurfaceMaterial materials;
	attribute long materialCount;
	[Value] attribute b2Filter filter;
	attribute boolean isLoop;
	attribute boolean enableSensorEvents;
	attribute long internalValue;
};

[StackAllocatable]
interface b2Filter {
    void b2Filter();
    attribute unsigned long long categoryBits;
    attribute long groupIndex;
    attribute unsigned long long maskBits;
};

[StackAllocatable]
interface b2QueryFilter {
    void b2QueryFilter();
    attribute unsigned long long categoryBits;
    attribute unsigned long long maskBits;
};

[StackAllocatable]
interface b2SurfaceMaterial {
    void b2SurfaceMaterial();
    attribute unsigned long customColor;
    attribute float friction;
    attribute float restitution;
    attribute float rollingResistance;
    attribute float tangentSpeed;
    attribute long userMaterialId;
};

[StackAllocatable]
interface b2ContactData {
    void b2ContactData();
    [Value] attribute b2Manifold manifold;
    [Value] attribute b2ShapeId shapeIdA;
    [Value] attribute b2ShapeId shapeIdB;
};

enum b2ShapeType {
    "b2_circleShape",
    "b2_capsuleShape",
    "b2_segmentShape",
    "b2_polygonShape",
    "b2_chainSegmentShape"
};